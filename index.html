<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Wedding Seating Search</title>

<style>
:root {
  --red: #b11226;
}

* {
  box-sizing: border-box;
  font-family: "Georgia", serif;
}

body {
  margin: 0;
  min-height: 100vh;
  background:
    linear-gradient(rgba(0,0,0,.35), rgba(0,0,0,.35)),
    url("background.png") center / cover no-repeat fixed;
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;
}

/* MAIN CARD */
.app {
  background: rgba(255,255,255,.92);
  color: #222;
  width: 95%;
  max-width: 420px;
  border-radius: 22px;
  padding: 26px;
  text-align: center;
  box-shadow: 0 25px 60px rgba(0,0,0,.4);
}

/* TITLE */
h1 {
  margin: 0 0 12px;
  color: var(--red);
  font-size: 26px;
}

/* SEARCH */
input {
  width: 100%;
  padding: 14px;
  font-size: 18px;
  border-radius: 14px;
  border: 2px solid var(--red);
  outline: none;
  margin-bottom: 14px;
}

input:focus {
  animation: heartBeat 1.6s infinite;
}

/* RESULTS LIST */
.results {
  margin-top: 12px;
}

.result {
  padding: 10px;
  border-bottom: 1px solid #ddd;
  cursor: pointer;
}

.result strong {
  color: var(--red);
}

/* POPUP */
.popup {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.6);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 99;
}

.popup-card {
  background: white;
  color: #222;
  padding: 28px;
  border-radius: 22px;
  text-align: center;
  width: 90%;
  max-width: 340px;
  animation: popIn .45s ease;
  box-shadow: 0 30px 80px rgba(0,0,0,.5);
}

.popup-card h2 {
  margin: 0;
  color: var(--red);
}

.big {
  font-size: 22px;
  font-weight: bold;
  margin-top: 14px;
}

/* ANIMATIONS */
@keyframes popIn {
  from { transform: scale(.7); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

@keyframes heartBeat {
  0% { box-shadow: 0 0 0 0 rgba(177,18,38,.4); }
  70% { box-shadow: 0 0 0 14px rgba(177,18,38,0); }
  100% { box-shadow: 0 0 0 0 rgba(177,18,38,0); }
}

/* PETALS */
.petal {
  position: fixed;
  width: 14px;
  height: 14px;
  background: radial-gradient(circle, pink, hotpink);
  border-radius: 50%;
  animation: fall 3s linear forwards;
  pointer-events: none;
  z-index: 100;
}

@keyframes fall {
  from { transform: translateY(-20px) scale(1); opacity: 1; }
  to { transform: translateY(110vh) scale(.3); opacity: 0; }
}
</style>
</head>

<body>

<div class="app">
  <h1>Find Your Seat</h1>
  <input id="search" placeholder="Type your nameâ€¦" autocomplete="off" />
  <div class="results" id="results"></div>
</div>

<div class="popup" id="popup" onclick="closePopup()">
  <div class="popup-card">
    <h2 id="pName"></h2>
    <div class="big">Table <span id="pTable"></span></div>
    <div class="big">Seat <span id="pSeat"></span></div>
  </div>
</div>

<script>
const CSV_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vRTHOySmu1LqBL9y25rwBHDflfv4TOwbmgUB8oJkxfMqQuSs9iEeYz29KoRQNyQYEcAoqZ2EPtPR7D3/pub?gid=0&single=true&output=csv";

let guests = [];

/* UTIL */
const normalize = s =>
  s.toLowerCase().trim().replace(/\s+/g," ");

fetch(CSV_URL)
  .then(r => r.text())
  .then(text => {
    const rows = text.split("\n").slice(1);
    guests = rows.map(r => {
      const [name, table, seat] = r.split(",");
      return { name, table, seat };
    });
  });

const input = document.getElementById("search");
const results = document.getElementById("results");

input.addEventListener("input", () => {
  const q = normalize(input.value);
  results.innerHTML = "";
  if (!q) return;

  const words = q.split(" ");

  const matches = guests.filter(g =>
    words.every(w => normalize(g.name).includes(w))
  );

  if (matches.length === 1) {
    showPopup(matches[0]);
  } else {
    matches.forEach(m => {
      const div = document.createElement("div");
      div.className = "result";
      div.innerHTML = `<strong>${m.name}</strong><br>Table ${m.table}, Seat ${m.seat}`;
      div.onclick = () => showPopup(m);
      results.appendChild(div);
    });
  }
});

/* POPUP */
function showPopup(g) {
  document.getElementById("pName").textContent = g.name;
  document.getElementById("pTable").textContent = g.table;
  document.getElementById("pSeat").textContent = g.seat;
  document.getElementById("popup").style.display = "flex";
  petals();
}

function closePopup() {
  document.getElementById("popup").style.display = "none";
}

/* PETALS */
function petals() {
  for (let i=0;i<18;i++) {
    const p = document.createElement("div");
    p.className = "petal";
    p.style.left = Math.random()*100 + "vw";
    p.style.animationDelay = Math.random()*1 + "s";
    document.body.appendChild(p);
    setTimeout(() => p.remove(), 3000);
  }
}
</script>

</body>
</html>
